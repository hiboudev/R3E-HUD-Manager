<?xml version="1.0" encoding="utf-8" ?>

<xml>

  <!--
  
Here we check some layout properties that are not supported by R3E,
and we associate those invalid cases with a description and when possible
with a fix.

Goal is to allow the user to get a comprehensive WYSIWYG layout, and not being
surprised by R3E displaying HUD elements in an unexpected way.


** Placeholder names:
*********************
MoTeC
Mini MoTeC
Position Bar
Virtual Mirror
Flags
Track Map
Apexhunt Display
Driver Name Tags
Car Status
FFB Graph

** property name:
**************
x
y
size
ax (anchor x)
ay (anchor y)

** check operator:
******************
>
<
>=
<=
=
!=

** check value:
*********
a float number
ANY (match any value, doesn't use the operator)

** placeholder:
****************
  To match all placeholders, just add no placeholder element to the rule.

** layout:
**********
single
triple
ANY

-->



  <rule name="Valid positions on left/right screen are only -1|1 except for FFB." layout="triple">

    <invalid property="x">
      <check value="1"><![CDATA[>]]></check>
      <check value="3"><![CDATA[<=]]></check>
      <description><![CDATA[This placeholder will be displayed by R3E at X=1 (left edge).]]></description>

      <fix>
        <property name="x" value="1"/>
        <property name="ax" value="-1"/>
      </fix>
    </invalid>

    <invalid property="x">
      <check value="-1"><![CDATA[<]]></check>
      <check value="-3"><![CDATA[>=]]></check>
      <description><![CDATA[This placeholder will be displayed by R3E at X=-1 (right edge).]]></description>

      <fix>
        <property name="x" value="-1"/>
        <property name="ax" value="1"/>
      </fix>
    </invalid>

    <placeholder name="MoTeC" />
    <placeholder name="Mini MoTeC" />
    <placeholder name="Position Bar" />
    <placeholder name="Virtual Mirror" />
    <placeholder name="Flags" />
    <placeholder name="Track Map" />
    <placeholder name="Apexhunt Display" />
    <placeholder name="Driver Name Tags" />
    <placeholder name="Car Status" />

  </rule>

  <rule name="Max size is 1." layout="ANY">

    <invalid property="size">
      <check value="1"><![CDATA[>]]></check>
      <description><![CDATA[Maximum placeholder size is 1.]]></description>

      <fix>
        <property name="size" value="1"/>
      </fix>
    </invalid>

  </rule>

  <rule name="Virtual Mirror Y" layout="ANY">
    <invalid property="y">
      <check value="ANY"><![CDATA[=]]></check>
      <description><![CDATA[Virtual mirror Y position is dynamically set by R3E.]]></description>
    </invalid>

    <placeholder name="Virtual Mirror" />
  </rule>

  <rule name="FFB anchor not movable" layout="ANY">
    <invalid property="ax">
      <check value="-1"><![CDATA[!=]]></check>
      <description><![CDATA[Anchor X position is forced to -1 by R3E (left).]]></description>

      <fix>
        <property name="ax" value="-1"/>
      </fix>
    </invalid>

    <invalid property="ay">
      <check value="-1"><![CDATA[!=]]></check>
      <description><![CDATA[Anchor Y position is forced to -1 by R3E (bottom).]]></description>

      <fix>
        <property name="ay" value="-1"/>
      </fix>
    </invalid>

    <placeholder name="FFB Graph" />
  </rule>

  <!--
  TODO FFB X position on left/center screen is not clear and needs more tests.
  It seems its X position is moved to the left by ~1/4 of its size. Sometimes it seems forced to -3.
  -->
  <!-- rule name="FFB on left screen always at X = -3." layout="triple">
    <invalid property="x">
      <check value="-1"><![CDATA[<]]></check>
      <check value="-3"><![CDATA[!=]]></check>
      <description><![CDATA[X position will be forced by R3E to -3 (left screen edge).]]></description>

      <fix>
        <property name="x" value="-3"/>
        <property name="ax" value="-1"/>
        <property name="ay" value="-1"/>
      </fix>
    </invalid>

    <placeholder name="FFB Graph" />
  </rule>

  <rule name="FFB on center screen always at X = -1." layout="triple">
    <invalid property="x">
      <check value="-1"><![CDATA[>]]></check>
      <check value="1"><![CDATA[<=]]></check>
      <description><![CDATA[X position will be X=-1.]]></description>

      <fix>
        <property name="x" value="-1"/>
        <property name="ax" value="-1"/>
        <property name="ay" value="-1"/>
      </fix>
    </invalid>

    <placeholder name="FFB Graph" />
  </rule -->

  <rule name="FFB X position on left/center screens is a bit unpredictable, except at X=-3" layout="triple">
    <invalid property="x">
      <check value="-3"><![CDATA[>]]></check>
      <check value="1"><![CDATA[<=]]></check>
      <description><![CDATA[FFB X position on left/center screens is a bit unpredictable, except at X=-3 (left screen left edge).]]></description>

      <fix>
        <property name="x" value="-3"/>
        <property name="ax" value="-1"/>
        <property name="ay" value="-1"/>
      </fix>
    </invalid>

    <placeholder name="FFB Graph" />
  </rule>

  <rule name="FFB doesn't show on right screen" layout="triple">
    <invalid property="x">
      <check value="1"><![CDATA[>]]></check>
      <check value="3"><![CDATA[<=]]></check>
      <description><![CDATA[FFB meter on right screen won't be displayed at all by R3E.]]></description>

      <fix>
        <property name="x" value="-3"/>
        <property name="ax" value="-1"/>
        <property name="ay" value="-1"/>
      </fix>
    </invalid>

    <placeholder name="FFB Graph" />
  </rule>

  <rule name="Position not taken into account by R3E" layout="ANY">
    <invalid property="x">
      <check value="ANY"><![CDATA[=]]></check>
      <description><![CDATA[This placeholder X position is not taken into account by R3E.]]></description>
    </invalid>

    <invalid property="x">
      <check value="ANY"><![CDATA[=]]></check>
      <description><![CDATA[This placeholder Y position is not taken into account by R3E.]]></description>
    </invalid>

    <placeholder name="Mini MoTeC" />
    <placeholder name="Driver Name Tags" />
    <placeholder name="Car Status" />
    <placeholder name="Flags" />
    <placeholder name="Apexhunt Display" />
  </rule>

  <rule name="Outside of screen range (triple)." layout="triple">

    <invalid property="x">
      <check value="-3"><![CDATA[<]]></check>
      <description><![CDATA[This placeholder X is outside of any screen.]]></description>

      <fix>
        <property name="x" value="-3"/>
        <property name="ax" value="-1"/>
      </fix>
    </invalid>

    <invalid property="x">
      <check value="3"><![CDATA[>]]></check>
      <description><![CDATA[This placeholder X is outside of any screen.]]></description>

      <fix>
        <property name="x" value="3"/>
        <property name="ax" value="1"/>
      </fix>
    </invalid>

    <invalid property="y">
      <check value="-1"><![CDATA[<]]></check>
      <description><![CDATA[This placeholder Y is outside of any screen.]]></description>

      <fix>
        <property name="y" value="-1"/>
        <property name="ay" value="-1"/>
      </fix>
    </invalid>

    <invalid property="y">
      <check value="1"><![CDATA[>]]></check>
      <description><![CDATA[This placeholder Y is outside of any screen.]]></description>

      <fix>
        <property name="y" value="1"/>
        <property name="ay" value="1"/>
      </fix>
    </invalid>

  </rule>

  <rule name="Outside of screen range (single)." layout="single">

    <invalid property="x">
      <check value="-1"><![CDATA[<]]></check>
      <description><![CDATA[This placeholder X is outside of screen.]]></description>

      <fix>
        <property name="x" value="-1"/>
        <property name="ax" value="-1"/>
      </fix>
    </invalid>

    <invalid property="x">
      <check value="1"><![CDATA[>]]></check>
      <description><![CDATA[This placeholder X is outside of screen.]]></description>

      <fix>
        <property name="x" value="1"/>
        <property name="ax" value="1"/>
      </fix>
    </invalid>

    <invalid property="y">
      <check value="-1"><![CDATA[<]]></check>
      <description><![CDATA[This placeholder Y is outside of screen.]]></description>

      <fix>
        <property name="y" value="-1"/>
        <property name="ay" value="-1"/>
      </fix>
    </invalid>

    <invalid property="y">
      <check value="1"><![CDATA[>]]></check>
      <description><![CDATA[This placeholder Y is outside of screen.]]></description>

      <fix>
        <property name="y" value="1"/>
        <property name="ay" value="1"/>
      </fix>
    </invalid>

  </rule>

</xml>